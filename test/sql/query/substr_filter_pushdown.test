# name: test/sql/query/substr_filter_pushdown.test
# description: Verify substring filter is pushed down into Mongo $expr
# group: [query]

require mongo

require-env MONGODB_TEST_DATABASE_AVAILABLE

statement ok
ATTACH 'host=localhost port=27017 dbname=duckdb_mongo_test' AS mongo_test (TYPE MONGO);

query II
EXPLAIN SELECT name FROM mongo_test.users WHERE substring(name, 1, 1) = 'A';
----
physical_plan	<REGEX>:[\s\S]*MONGO_SCAN[\s\S]*expr[\s\S]*\$substrCP[\s\S]*

query I
SELECT name FROM mongo_test.users WHERE substring(name, 1, 1) = 'A' ORDER BY name;
----
Alice

statement ok
DETACH mongo_test;
