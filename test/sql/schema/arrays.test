# name: test/sql/schema/arrays.test
# description: Test schema inference for arrays
# group: [schema]

require mongo

require-env MONGODB_TEST_DATABASE_AVAILABLE

statement ok
ATTACH 'host=localhost port=27017 dbname=duckdb_mongo_test' AS mongo_test (TYPE MONGO);

# Test that arrays are stored as JSON/VARCHAR columns
# Arrays should be queryable as JSON strings
query I
SELECT COUNT(*) FROM mongo_test.users WHERE tags IS NOT NULL;
----
4

# Test array field exists
query II
SELECT name, tags FROM mongo_test.users WHERE name = 'Alice';
----
Alice	["admin","user"]

# Test array in products
query II
SELECT name, tags FROM mongo_test.products WHERE name = 'Laptop';
----
Laptop	["computer","electronics","laptop"]

statement ok
DETACH mongo_test;

